\section{Modeling and Simulation}
\label{sec:modeling}
For the purpose of doing design verification and optimization, a simplified model of the robot was created. The model was created in Simscape, a physical modeling toolbox integrated with MATLAB/Simulink. 
\subsection{Simscape}

Simscape is a simulation tool that allows you to rapidly create models of physical systems within Mathworks' MATLAB/Simulink environment. With Simscape, physical systems are built by interconnecting blocks representing physical components, such as rigid bodies, joints and springs in a block diagram. The blocks are parameterized by physical properties, such as mass, inertia, and damping. Simscape automatically generates the equations of motion for the system, which can be solved numerically to simulate the system's behavior. Like you can do with Simulink without Simscape, you can also add ordinary Simulink blocks, including Matlab Function blocks, to the model. 

%\subsection{Simscape}
%Simscape is a physical modeling toolbox integrated with MATLAB/Simulink. While Simulink handles signal-based modeling through block diagrams, Simscape adds the ability to model physical components and their interactions directly. For this project, its multibody library was used to create a simplified model of the robot. The key advantage is automatic handling of complex multi-body dynamics equations. Rather than manual derivation, Simscape generates them based on specified geometry and joints. The model parameters can be easily modified through MATLAB scripts.

%\subsection{Motor Torque-Speed Characteristics}
%To model the motor torque-speed characteristics, a torque-speed curve such as the one covered in section \ref{sec:theory:motor_model} was used, with parameters as covered in section \ref{sec:hardware:motor_characteristics}.



%\subsection{Motor Friction Modelling}
%Since the motors will be turned off during the jumping maneuver, motor friction must be included. It was modelled using a linear motor friction model covered in section \ref{sec:theory:motor_model}, using only the viscous friction component. To estimate the model parameters, we performed hardware tests for each motor, where the motors acted as the axis of rotation for a pendulum. A aluminium rod with a aluminium ballast was attacted to the motor shaft, and the pendulum was released from rest at horizontal position and allowed to swing freely untill at rest. This was repeated for both motors. The tests where filmed by a phone camera placed at a distance in front of the pendulum, and the angles of the pendulum were manually annotated using Tracker \cite{tracker}. The hardware setup is shown in figure \ref{fig:motor_friction_test_setup}, and the results are shown in figure \ref{fig:results:motor_friction_test}.

\section{Link Length Optimization}

\subsection{Motivation}
The robot must have reasonable jumping performance to be suitable for training and demonstrating the future RL control policies. One of the main design aspects that determines the jumping performance is the length of the thigh and shank links. The link lengths impact the robots mass, mass distribution, and acts as constraints for initial jumping poses and spring compression. Which in turn affect how jumps are performed and thus jumping performance. To find the optimal link lengths, a grid search was performed. To do this, a simplified model of the robot was created in Simscape, the details of this are covered in the section \ref{sec:modeling}.


\subsubsection{Pendulum Modeling}

The pendulum used in the motor friction tests consists of an aluminum rod of length \( l_{\text{arm}} = 0.19 \) meters and a ballast mass \( m_{\text{ballast}} = 0.301 \) kg attached at a distance \( r = 0.08 \) meters from the pivot. The total mass of the arm is \( m_{\text{arm}} = 0.034 \) kg. The pendulum is modeled as a rigid body rotating about the motor shaft with a moment of inertia \( I \) given by:

\[
I = \frac{1}{3} m_{\text{arm}} l_{\text{arm}}^2 + m_{\text{ballast}} r^2
\]

The equation of motion for the pendulum, considering only viscous friction, is:

\[
I \ddot{\theta} + b \dot{\theta} + (m_{\text{arm}} \frac{l_{\text{arm}}}{2} + m_{\text{ballast}} r) g \sin(\theta) = 0
\]

where:
\begin{itemize}
    \item \( \theta \) is the angular displacement (positive counterclockwise, zero at vertical down position)
    \item \( \dot{\theta} \) and \( \ddot{\theta} \) are the angular velocity and acceleration, respectively
    \item \( b \) is the viscous damping coefficient
    \item \( g = 9.81 \, \text{m/s}^2 \) is the acceleration due to gravity
\end{itemize}
\subsubsection{Linear Regression Derivation}
Rearranging the equation for linear regression purposes:

\[
    I \ddot{\theta} + (m_{\text{arm}} \frac{l_{\text{arm}}}{2} + m_{\text{ballast}} r) g \sin(\theta) = -b \dot{\theta}
\]

This can be expressed in the form:

\[
Y = X \beta
\]

where:
\begin{itemize}
    \item \( Y = -I \ddot{\theta} - (m_{\text{arm}} \frac{l_{\text{arm}}}{2} + m_{\text{ballast}} r) g \sin(\theta) \),
    \item \( X = \dot{\theta} \),
    \item \( \beta = b \).
\end{itemize}

The angular velocity \( \dot{\theta} \) and acceleration \( \ddot{\theta} \) are computed using centered finite differences:

\[
\dot{\theta}_i = \frac{\theta_{i+1} - \theta_{i-1}}{2\Delta t}
\]

\[
\ddot{\theta}_i = \frac{\theta_{i+1} - 2\theta_i + \theta_{i-1}}{(\Delta t)^2}
\]

where \(\Delta t\) is the time step between measurements.

The linear least squares solution for \( \beta \) is given by:

\[
\beta = (X^T X)^{-1} X^T Y
\]

This yields the viscous damping coefficient \( b \).




\subsection{Initial Pose Calculation}

\subsection{Symmetric versus Asymmetric legs}

\subsection{Grid Search}